#!/bin/bash
CURRENT_DIR=$(pwd)
REPO_DIR="/c/Users/shaun/repos/"
S3_REPO="s3://solidrust.net-repository"

# mkdir -p ${REPO_DIR}/solidrust.net #&& git checkout
echo "Creating SRT Build marker"
cd ${REPO_DIR}/solidrust.net
git fetch --tags
git rev-parse --short HEAD | tee build.txt
git tag | tac | tee -a build.txt
cd ${CURRENT_DIR}

export S3_COMMAND="sync --delete"
echo "Pushing SRT Build marker"
aws s3 cp ${REPO_DIR}/solidrust.net/build.txt ${S3_REPO}/
echo "Pushing SRT Defaults"
aws s3 ${S3_COMMAND} ${REPO_DIR}/solidrust.net/defaults/ ${S3_REPO}/defaults/
echo "Pushing SRT Custom Servers"
aws s3 ${S3_COMMAND} ${REPO_DIR}/solidrust.net/servers/ ${S3_REPO}/servers/
echo "Pushing SRT Web"
aws s3 ${S3_COMMAND} ${REPO_DIR}/solidrust.net/web/ ${S3_REPO}/web/
echo "Pushing SRT Radio"
aws s3 ${S3_COMMAND} ${REPO_DIR}/radio/ s3://solidrust.net-radio/